---
url: https://www.youtube.com/watch?v=eUFf5eFpdLg
date: 2024-10-15
aliases: 
status: complete
tags:
  - web
---
# Notes

# Content


# Transcript
# Time-Frequency Analysis of EEG Time Series Part 3: Wavelet Transforms - YouTube
https://www.youtube.com/watch?v=eUFf5eFpdLg

![](https://www.youtube.com/watch?v=eUFf5eFpdLg)
## Transcript:
- [00:00](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=0s) hello my name is arnold deloren and this is part three of a series of video on time frequency analysis of eg time series this part is about wavelet transforms first let's talk about the eisenberg's insurgency principle in principle states that there is a tradeoff between time and frequency resolution there is a lower bound to the product of delta frequency times delta times and it is the inverse of 4 pi delta f is the difference between two successive frequencies so it's the frequency resolution and delta t is the difference between
- [00:35](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=35s) successive time samples so it's the time resolution for example if delta frequencies is one hertz so one hertz resolution the minimum time resolution is 80 milliseconds if you multiply one hertz by 0.08 second you're just above the inverse of 4 pi with 2 hertz resolution the minimum time resolution is 40 milliseconds etc why is this important for eeg well eeg may contain short bursts at high frequency for which we need high time resolution here at gamma for example and in eg there is also longer oscillation
- [01:14](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=74s) at low frequencies for with for which we need relatively high frequency resolution here at feta for example the problem is that the fourier transform has a constant time resolution at all frequencies that depends on the size of the signal or time window can we adapt time frequency resolution for individual frequencies to improve spectral estimation yes we can as mentioned earlier we can compute the fourier transform by convolving the signal the complex in a solid at some frequencies of interest we can taper our sinusoid for example
- [01:49](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=109s) with the gaussian window as represented here to localize our wavelets in time and reduce gibbs rippling at the edges then at each time point we call it the signal with this wavelet as shown here this gives us at each time point an estimate of the spectral power in the signal at that frequency the advantage is that we can design the wavelet at each frequency to be diffused or well localized in time to optimize the trade-off between time and frequency resolution by convolving stretch and scaled version of what is commonly called the mother
- [02:26](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=146s) wavelets with the eeg signal we determine the power at different times and frequencies here on the bottom you can see power for the 5 hertz version of the wavelets in red for the 10 hertz version in blue and for the 40 hertz version in green only the 10 hertz version shows a substantial increase in power because the eeg signal only contains oscillations at 10 hertz another way of representing this is using a 2d time frequency plot as shown here note that different wavelets may be better adapted for different kinds of
- [03:02](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=182s) eeg signal in general in eeg we use the mole wavelet which is the sinusoid times the gaussian however in brain computer interface research when researchers try to extract the most relevant eeg signal features for features for classification purposes it is common to use other types of wavelets such as the one represented here as i mentioned earlier there is always a trade-off between time and frequency a wavelet is a packet of energy localized in time and frequency the width of the wavelet depends on the standard deviation of the
- [03:38](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=218s) gaussian windowing taper for the mole wavelets the width determine how accurately a change in amplitude can be localized in time let's consider two male wavelets one with a wide window on the left and one with the narrow window on the right if we apply the wide window wavelet to a 10 hertz eg signal containing itself 10 hertz oscillation we will find a perfect correlation all the peaks match up this is true both for the wide and the narrow window wavelet now if the eeg frequency that is at 8.
- [04:13](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=253s) 5 hertz so slightly lower than the wavelet frequency then the large window wavelet will indicate poor correlation at 10 hertz this is because only the signal central peak match the wavelets by contrast the peripheral peak are anti-correlated with the wavelet so this is what we should expect however the small window wavelets will still be highly correlated with the signal at 8.
- [04:39](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=279s) 5 hertz as all the peaks almost line up this is something that indicates poor frequency resolution similarly if the eeg frequency is at 11.5 hertz so slightly higher than the wavelet frequency then the large window wavelet will indicate a low correlation at 10 hertz it's a good frequency resolution however the small window wavelet will produce high correlation against something that indicates poor frequency resolution as the wide window wavelet is better able to localize the amplitude of the signal in frequency but less able to localize
- [05:16](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=316s) the signal in time compared to the narrow window wavelet which has the opposite properties let's look at how we can use the time frequency tradeoff of wavelets these represent time series with fixed time resolution and no frequency resolution by contrast this represents a fourier transform with fixed frequency resolution and no time resolution as we've seen when we compute the power spectrum all time resolution is lost now this is a short time for a transform where we segment time in different windows now we can have both fixed time and
- [05:54](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=354s) frequency resolution in each window and finally this is a wavelet transform where we can adapt the width of the wavelet so it's time resolution to the frequency of interest so it produces better time frequency resolution tradeoff it can have high frequency resolution and low time resolution at low frequencies of the eeg and lower frequency resolution high time resolution at higher frequencies in the eeg in eeg lab we use a parameter the scale expansion factor that automatically adapts the time frequency resolution by
- [06:29](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=389s) adjusting the width of the mole wavelet on the left a scale version a scale expansion factor of zero is equivalent to a tapered short time for a transform this means that we keep the window size and time resolutions constant across all frequency and we increase the number of cycles with frequencies on the other extreme on the right a scale expansion factor of 1 will keep the number of cycle constant while decreasing the size of the window again the first wavelet produce low time resolution and high frequency resolution
- [07:04](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=424s) for low frequencies in the eeg and the second one high time resolution and low frequency resolution for high frequencies in eeg if you consider frequencies which are a power of 2 so two hertz four hertz eight hertz 16 hertz etc and a scale expansion factor of one you have what we call true wavelets as defined in textbooks these are used for signal compression or other signal processing applications such as denoising here our goal is visualization of eg data so we do not want to restrict ourselves to using frequencies which are power f2 we
- [07:42](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=462s) might want to have linear increments in frequencies such as represented here we might also want to use different scale expansion factors with wavelets having different numbers of cycles at different frequencies for example with a wavelet expansion factor of 0.5 the size of the window at the highest frequency is about half the size of within the window at the lowest frequency a value we will typically use for eeg applications is 0.
- [08:11](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=491s) 8 as it provides a good time frequency trader for both low and high frequencies the eeg lab we can also specify manually the exact number of cycle and size of window for each frequency and i will show you how to do that in one of the following presentations so the wavelets we use for eg signal visualization are modified wavelets not true have let's use for compression and denoising on this slide i show some plots obtained with eg lab here you see how a scale expansion factor of zero produces smearing across time at all frequencies and again
- [08:48](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=528s) this is equivalent to performing a short time fourier transform and here you see a scale expansion factor of ones when you're smearing across frequencies for all time windows so that's what we need is something in between such as the scale expansion factor of 0.8 for example let's quickly review alternative methods for time frequency decomposition of eeg data first the hilbert transform the helper transform return phase and amplitude of a signal through time usually first the signal is band pass filtered in the frequency
- [09:21](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=561s) range of interest for example between 8 and 12 hertz for alpha rhythm and then the hilbert transform can provide amplitude and phase through time in this plot we start with a signal band pass filter in red and then we extract amplitude and phase of the complex hilbert estimate the result is similar to using a windowed fft or wavelet approach if you're not convinced i invite you to look at the reference on this slide this is not available from the egl graphic interface but you can easily apply it to an each lab data
- [09:55](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=595s) structure by calling the matlab helper transform function on the matlab command line and then finally we have the multi-taper approach for fourier transform we usually apply one taper as shown here to the signal for example we multiply the signal by gaussian taper with a multi-taper approach it is similar but we apply multiple orthogonal tapers perform fft compute spectrum and then average this spectra the advantage is that we reduce variance proportionally to the number of tapers however we also decrease time frequency resolution proportionally to
- [10:38](https://www.youtube.com/watch?v=eUFf5eFpdLg&t=638s) the number of tapers so this approach is only used for high eg frequencies above 30 hertz where we can afford to lose a time resolution if you want to use multi-taper to compute a spectrum you can use the matlab pmtn function on eglab data structures for time frequency decompositions you can use the eglab time function from the matlab command line i want to thank you for your attention and i'll see you in the next video