---
url: https://www.youtube.com/watch?v=BcOuRxeZTtA
date: 2024-10-15
aliases: 
status: complete
tags:
  - web
---
# Notes

# Content


# Transcript
# Time-Frequency Analysis of EEG Time Series Part 2: EEG Spectrum and ERSP - YouTube
https://www.youtube.com/watch?v=BcOuRxeZTtA

![](https://www.youtube.com/watch?v=BcOuRxeZTtA)
## Transcript:
- [00:00](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=0s) hello my name is arnold delorean and this is part two of a series of video on time frequency analysis of eeg time series this part is about the eeg spectrum and eeg event related spectral perturbation or ersps in some cases when a signal here is so that 100 hertz is sampled at a given frequency here at 80 hertz the resulting samples so the dots here might be instantly indistinguishable from those of another sinusoid at the lower frequency this is called aliasing frequencies and these aliasing frequencies can be
- [00:36](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=36s) calculated using this formula in red where we vary an integer n in this case using this formula if we set n to 1 we obtain the aliasing frequency of 100 minus 80 equals 20 hertz how can we be sure to recover the original sinusoid signal that's the concept of nyquist frequency the nyquist frequency is the maximum frequency that can be uniquely recovered at a given sampling frequency and it is half the sampling frequency so in this case since the sampling frequency is 80 hertz we cannot recover at a signal but at a
- [01:09](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=69s) higher frequency than 40 hertz if you are interested in processes in the gamma range of eeg so 40 to 80 hertz you need to collect the data with a sampling rate of at least 160 hertz so let's look at the related concept which is zero padding the fourier transform of a sequence of length hand produce power estimates at the end frequencies evenly distributed between zero and the sampling rate or n divided by by two frequencies between zero and the nyquist rate since we usually do not look at frequencies above the nyquist rates padding the
- [01:48](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=108s) signal with zeros on both sides achieves two things first it allows enforcements of a signal of length as a power of two that helps with the mathematical trick implementing advisory transform which i mentioned in previous video second it artificially increases the number of frequency bins so if you have 200 samples in one second you would need to you would get 200 frequencies from zero to 200 hertz now if you are padding with hundreds 100 zeros on each side now you have 400 samples so 400 frequencies from 0 to 200 hertz
- [02:26](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=146s) so you have effectively doubled the number of frequencies this is shown here in this plot with the blue dots representing the non-zero padded version and the red line representing a heavy-duty zero padded version not that this should not be considered as it should only be considered as a type of interpolation or smoothing method as it does not increase frequency resolutions in other words it's not the same as doubling the sampling rate because you do not add any new information with fourier transform we may exactly
- [03:00](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=180s) represent any continuous stationary signal of length n using a weighted sum of n sinusoid so if you have a discontinuity in your signal how can you represent that using a limited number of smooth sinusoids well you can't here in red we have a step signal which is that approximated using two four or eight sinusoids we observe ripples in a reconstructed signal due to the discontinuity and these are due to a phenomenon called the gibbs phenomenon and the same phenomenon happens at the age of eg signal or if we have an eeg
- [03:37](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=217s) signal padded with 0 as shown here and here we have another discontinuity a direct signal that is also approximated using 2 4 or 8 sinusoids and shows ripple in the reconstructed signal so if we wanted to get rid of these ripples we could use an infinite number of sinusoids at different frequencies which means we would need a signal with an infinite number of samples since the number of frequencies depend on the number of samples and of course it's not possible so what can we do we can taper the data which means
- [04:12](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=252s) multiplying the signal with a smooth signal that decays to zero at the edges here we multiply the eeg signal with a red gaussian signal also called the taper and we obtain an eg signal with no sharp edges so tapering reduces the effect of gibbs phenomenon here we can see that the amplitude of the ripples is much lower for the tapered signal compared to the end tapered signal however the cost is an increased width of the central peak which also means loss of resolution the reason that the central peak increases in width
- [04:50](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=290s) when side ripples are suppressed is because the total variance may remain constant in suppressing gibbs ripples we are simply shifting energy out of frequency distributed over the entire spectrum into frequencies near the central peak now let's look at how to compute the spectrum of the aeg signal a method which is usually widely used is called the welsh methods and consists in segmenting or slicing the data into different windows and tapering them as i've shown before for each window at a given frequency we
- [05:25](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=325s) obtain a phase vector and then we can average the length uh the square length of this phase vector to obtain the spectral power at that frequency if your k segments this reduce the total variance by a factor of k it also reduced the frequency resolution by a factor k but the loss of frequency resolution is usually not so important from the user standpoints if you have one second segment it means that your frequency resolution will be one hertz which is acceptable in most cases here potential problem is that tapering
- [05:57](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=357s) may may result in data loss we are missing the data at the edge of the taper since it has been zeroed out so how can we mitigate this data loss we can simply have the window of a lap as shown here then we average the square length of the phase vector to obtain spectral power as we did before and now we can have the base of both world spectral variance reduction and reduced data loss you can also have data trials in eeg so in addition to segmenting the data and averaging spectral estimates over the segments you can also average spectral estimates
- [06:36](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=396s) across trials and if you have any independent trials this will further reduce the variance by a factor of n up to now we have assumed the signal as stationary which means that the statistics of the signal doesn't change with time but most eg signals don't have this property for example here we have an alpha burst and as it might occur in the lateral visual system following the presentation of the stimulus our examples of non-stationary signals include evoked potential and chirp we can extend the concept of spectral
- [07:12](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=432s) decomposition of stationary signal to spectral the composition of a time window where we'll use a sliding window across a signal and obtain a spectral estimate across at each time this allows us to produce a spectrogram which is also called time frequency image if we have multiple trials available we can average to improve our resolution further reduce variance because because the spectral change are following the presentation of a stimulus or event we call these event related spectral perturbation this is the equation which is being used to
- [07:51](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=471s) calculate even related spectral perturbation you can see that at a given time in frequency you can simply average the square of the length of the phase vector across trials usually when looking at this measure we scale them to db by simply taking 10 times the base 10 logarithm this way it's easier to visualize change in spectral power something else we usually do with this spectral image is to remove the baseline so it's easier to visualize spectral changes following the presentation of a stimulus here's at
- [08:23](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=503s) time zero so at each frequency we calculate spectral power before the presentation of the stimulus and we subtract it uh we subtract this average value from the values at all time windows and we do that for each frequency separately so the resulting this is the resulting image and you can see that it is much easier to visualize spectral changes following the presentation of the stimulus here we can see an increase at 10 hertz and another decrease at 30 hertz and i want to mention that there are different ways to compute this
- [08:56](https://www.youtube.com/watch?v=BcOuRxeZTtA&t=536s) baseline i've included a reference here where we discussed this subject so i want to thank you for your attention and i'll see you in the next video